plugin "testy" {
    version = "0.1.0"
    description= "I test stuff"

    readme = file("README.md")

    run "server" {
        cmd=["python","main.py"]
        api="unix://testy.sock"
    }

    run "cronjob" {
        cron = "@every 3s"
        cmd = ["python","cronjob.py"]
    }

    events = {
        "myevent": "gi!"
    }

    routes = {
        "/api/testy/*": "run://server"
    }

    on "app_update" {
        post = "run://server/cupdate"
    }

    app "tree" {
        auto_create = true
        on "app_settings_update" {
            post = "run://server/cupdate"
        }
        name="myapp"
        description = "lolza"
        settings_schema = jsondecode(file("settings.json"))

        source "tee" {
            name = "hee"
            type = "stream"
            on "source_update" {
                post = "unix://testy.sock/supdate"
            }
        }

    }
}